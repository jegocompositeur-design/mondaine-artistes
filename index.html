{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="fr">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>MONDAINE ARTISTES - Intranet</title>\
    <script src="https://cdn.tailwindcss.com"></script>\
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">\
    \
    <style>\
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&family=Playfair+Display:wght@700&display=swap');\
\
        body \{\
            font-family: 'Montserrat', sans-serif;\
            background: radial-gradient(circle at top left, #1a0b2e 0%, #050505 100%);\
            color: #e5e5e5;\
        \}\
\
        h1, h2, h3, .font-serif \{\
            font-family: 'Playfair Display', serif;\
        \}\
\
        .fade-in \{ animation: fadeIn 0.4s ease-out forwards; \}\
        @keyframes fadeIn \{\
            from \{ opacity: 0; transform: translateY(10px); \}\
            to \{ opacity: 1; transform: translateY(0); \}\
        \}\
\
        /* Animation pour le dropdown des dates */\
        @keyframes slideDown \{\
            from \{ opacity: 0; transform: translateY(-10px); max-height: 0; \}\
            to \{ opacity: 1; transform: translateY(0); max-height: 200px; \}\
        \}\
        .schedule-dropdown \{\
            animation: slideDown 0.3s ease-out forwards;\
            overflow: hidden;\
        \}\
        \
        /* Toast Notification Animation */\
        @keyframes slideUpFade \{\
            0% \{ transform: translate(-50%, 100%); opacity: 0; \}\
            10% \{ transform: translate(-50%, -20%); opacity: 1; \}\
            90% \{ transform: translate(-50%, -20%); opacity: 1; \}\
            100% \{ transform: translate(-50%, 100%); opacity: 0; \}\
        \}\
        .toast-visible \{\
            animation: slideUpFade 3s ease-in-out forwards;\
        \}\
\
        ::-webkit-scrollbar \{ width: 8px; height: 8px; \}\
        ::-webkit-scrollbar-track \{ background: #0f0f13; \}\
        ::-webkit-scrollbar-thumb \{ background: #4a1d96; border-radius: 4px; \}\
        ::-webkit-scrollbar-thumb:hover \{ background: #d946ef; \}\
\
        .nav-item.active \{\
            border-left-color: #d946ef;\
            background-color: rgba(217, 70, 239, 0.1);\
            color: #d946ef;\
            text-shadow: 0 0 10px rgba(217, 70, 239, 0.4);\
        \}\
\
        /* Mode "Menu R\'e9duit" forc\'e9 */\
        .sidebar-collapsed \{\
            width: 5rem !important; /* w-20 */\
        \}\
        .sidebar-collapsed .nav-text \{\
            display: none !important;\
        \}\
        .sidebar-collapsed .logo-text \{\
            display: none !important;\
        \}\
\
        /* --- STYLES PLANNING --- */\
        .planning-cell \{\
            transition: all 0.2s;\
            border-color: rgba(255,255,255,0.1);\
        \}\
        .planning-cell.interactive:hover \{\
            filter: brightness(1.2);\
            border-color: rgba(255,255,255,0.5);\
            transform: scale(1.02);\
            z-index: 5;\
            box-shadow: 0 0 10px rgba(255,255,255,0.1);\
        \}\
        \
        .artist-pill \{ transition: all 0.2s; \}\
        .artist-pill:hover \{ transform: scale(1.05); \}\
        .artist-pill.selected \{\
            box-shadow: 0 0 15px rgba(255,255,255,0.5);\
            transform: scale(1.05);\
            z-index: 10;\
            border: 2px solid white;\
        \}\
\
        .month-char \{\
            -webkit-text-stroke: 1px rgba(255, 255, 255, 0.8);\
            color: transparent;\
            line-height: 0.9;\
        \}\
        .month-sidebar \{\
            background: linear-gradient(180deg, #d946ef 0%, #7e22ce 100%);\
            box-shadow: 5px 0 20px rgba(0,0,0,0.5);\
        \}\
\
        .header-blue \{ background: linear-gradient(90deg, #1e40af, #1d4ed8); \}\
        .header-purple \{ background: linear-gradient(90deg, #6b21a8, #7e22ce); \}\
        .header-pink \{ background: linear-gradient(90deg, #be185d, #db2777); \}\
        .header-indigo \{ background: linear-gradient(90deg, #4338ca, #6366f1); \}\
        \
        /* Admin Textareas */\
        .admin-textarea \{\
            background-color: rgba(0,0,0,0.3);\
            border: 1px solid rgba(255,255,255,0.1);\
            color: #ddd;\
            font-family: monospace;\
            font-size: 0.85rem;\
            transition: border-color 0.3s;\
        \}\
        .admin-textarea:focus \{\
            outline: none;\
            border-color: #d946ef;\
        \}\
\
        /* Color Picker Swatches */\
        .color-swatch \{\
            width: 24px;\
            height: 24px;\
            border-radius: 50%;\
            cursor: pointer;\
            border: 2px solid transparent;\
            transition: all 0.2s;\
        \}\
        .color-swatch:hover \{\
            transform: scale(1.2);\
        \}\
        .color-swatch.active \{\
            border-color: white;\
            transform: scale(1.2);\
            box-shadow: 0 0 10px rgba(255,255,255,0.5);\
        \}\
        .color-swatch.used \{\
            opacity: 0.3;\
            transform: scale(0.8);\
        \}\
        .color-swatch.used:hover \{\
            opacity: 1;\
            transform: scale(1.1);\
        \}\
\
        /* Audio Player Styles */\
        .track-item \{\
            transition: all 0.2s;\
        \}\
        .track-item:hover \{\
            background-color: rgba(255,255,255,0.05);\
            padding-left: 1rem;\
        \}\
        .track-item.active \{\
            background: linear-gradient(90deg, rgba(217, 70, 239, 0.2) 0%, transparent 100%);\
            border-left: 4px solid #d946ef;\
            padding-left: 1rem;\
            color: #d946ef;\
        \}\
        .player-btn \{\
            transition: all 0.2s;\
        \}\
        .player-btn:active \{\
            transform: scale(0.95);\
        \}\
        \
        /* Glassmorphism for Audio Panel */\
        .glass-panel \{\
            background: rgba(20, 10, 30, 0.8);\
            backdrop-filter: blur(20px);\
            border-left: 1px solid rgba(255,255,255,0.1);\
        \}\
        \
        /* Range Sliders */\
        input[type=range] \{\
            -webkit-appearance: none;\
            background: transparent;\
        \}\
        input[type=range]::-webkit-slider-thumb \{\
            -webkit-appearance: none;\
            height: 12px;\
            width: 12px;\
            border-radius: 50%;\
            background: #d946ef;\
            cursor: pointer;\
            margin-top: -4px;\
        \}\
        input[type=range]::-webkit-slider-runnable-track \{\
            width: 100%;\
            height: 4px;\
            cursor: pointer;\
            background: rgba(255,255,255,0.2);\
            border-radius: 2px;\
        \}\
    </style>\
</head>\
<body class="flex h-screen overflow-hidden text-sm md:text-base">\
\
    <!-- SIDEBAR -->\
    <aside id="main-sidebar" class="w-20 md:w-64 bg-black/80 backdrop-blur-xl border-r border-white/10 flex flex-col z-50 shrink-0 transition-all duration-300 relative">\
        <div class="p-4 md:p-8 text-center">\
            <div class="w-10 h-10 md:w-16 md:h-16 bg-gray-900 rounded-full mx-auto flex items-center justify-center mb-3 border border-purple-500/30 shadow-[0_0_15px_rgba(168,85,247,0.2)]">\
                <i class="fas fa-microphone-alt text-xl md:text-2xl text-fuchsia-500"></i>\
            </div>\
            <h2 class="hidden md:block logo-text text-xs tracking-widest uppercase text-purple-300 font-bold">Espace Priv\'e9</h2>\
        </div>\
        \
        <nav class="flex-1 mt-6 relative z-50">\
            <ul class="space-y-2">\
                <li><a href="#" onclick="showPage('home')" id="nav-home" class="nav-item active flex items-center justify-center md:justify-start px-2 md:px-8 py-4 text-gray-400 hover:text-white transition-all border-l-4 border-transparent"><i class="fas fa-home w-6 text-center"></i><span class="hidden md:inline nav-text ml-3 font-bold tracking-wide">ACCUEIL</span></a></li>\
                <li><a href="#" onclick="showPage('planning')" id="nav-planning" class="nav-item flex items-center justify-center md:justify-start px-2 md:px-8 py-4 text-gray-400 hover:text-white transition-all border-l-4 border-transparent"><i class="far fa-calendar-alt w-6 text-center"></i><span class="hidden md:inline nav-text ml-3 font-bold tracking-wide">PLANNING</span></a></li>\
                <li><a href="#" onclick="showPage('setlist')" id="nav-setlist" class="nav-item flex items-center justify-center md:justify-start px-2 md:px-8 py-4 text-gray-400 hover:text-white transition-all border-l-4 border-transparent"><i class="fas fa-music w-6 text-center"></i><span class="hidden md:inline nav-text ml-3 font-bold tracking-wide">SET LISTE</span></a></li>\
                <li><a href="#" onclick="showPage('audio')" id="nav-audio" class="nav-item flex items-center justify-center md:justify-start px-2 md:px-8 py-4 text-gray-400 hover:text-white transition-all border-l-4 border-transparent"><i class="fas fa-headphones w-6 text-center"></i><span class="hidden md:inline nav-text ml-3 font-bold tracking-wide">AUDIO</span></a></li>\
                \
                <!-- Lien Admin Cach\'e9 -->\
                <li id="admin-nav-item" class="hidden mt-8 border-t border-white/10 pt-4">\
                    <a href="#" onclick="showPage('admin-panel')" id="nav-admin-panel" class="nav-item flex items-center justify-center md:justify-start px-2 md:px-8 py-4 text-red-400 hover:text-red-300 hover:bg-red-900/20 transition-all border-l-4 border-transparent">\
                        <i class="fas fa-cogs w-6 text-center"></i>\
                        <span class="hidden md:inline nav-text ml-3 font-bold tracking-wide">ADMINISTRATION</span>\
                    </a>\
                </li>\
            </ul>\
        </nav>\
\
        <div class="p-4 border-t border-white/10 text-center relative z-50">\
             <!-- Sidebar Toggle (Remplacement du plein \'e9cran) -->\
             <button onclick="toggleSidebar()" class="mb-4 text-gray-500 hover:text-white transition-colors w-full flex items-center justify-center cursor-pointer" title="R\'e9duire/Agrandir Menu">\
                <i id="sidebar-icon" class="fas fa-compress-alt text-lg"></i>\
                <span class="hidden md:inline nav-text ml-2 text-xs font-bold uppercase">R\'e9duire Menu</span>\
             </button>\
\
             <button onclick="toggleAdminMode()" id="admin-toggle-btn" class="text-gray-500 hover:text-fuchsia-400 transition-colors w-full flex items-center justify-center py-4 cursor-pointer group relative">\
                <div class="absolute inset-0 bg-white/5 opacity-0 group-hover:opacity-10 rounded-lg transition-opacity"></div>\
                <i class="fas fa-lock group-hover:scale-110 transition-transform text-lg"></i> \
                <span class="hidden md:inline nav-text ml-2 text-xs font-bold uppercase">Admin</span>\
            </button>\
        </div>\
    </aside>\
\
    <!-- MAIN CONTENT -->\
    <main class="flex-1 relative overflow-hidden w-full z-0">\
        \
        <!-- HOME -->\
        <section id="home" class="page-section h-full w-full absolute inset-0 z-10">\
            <div class="h-full w-full flex flex-col justify-center items-center text-center p-4" \
                 style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(20,0,30,0.9)), url('https://images.unsplash.com/photo-1514525253440-b393452e8d26?q=80&w=2000&auto=format&fit=crop'); background-size: cover; background-position: center;">\
                <div class="border-[6px] border-white/20 p-8 md:p-16 backdrop-blur-md bg-black/40 fade-in shadow-2xl">\
                    <h1 class="text-5xl md:text-8xl font-bold text-white tracking-tighter mb-2 drop-shadow-lg">MONDAINE</h1>\
                    <h2 class="text-2xl md:text-4xl text-fuchsia-500 tracking-[0.5em] font-light font-sans drop-shadow-[0_0_10px_rgba(217,70,239,0.5)]">ARTISTES</h2>\
                </div>\
            </div>\
        </section>\
\
        <!-- PLANNING -->\
        <section id="planning" class="page-section h-full w-full absolute inset-0 hidden flex flex-col fade-in z-10">\
            <header class="flex justify-between items-center p-6 md:px-10 border-b border-white/5 bg-black/20 shrink-0 backdrop-blur-sm">\
                <h2 class="text-4xl md:text-5xl text-white font-black uppercase tracking-tighter drop-shadow-lg">Planning</h2>\
                <div class="flex items-center gap-3">\
                    <div class="flex items-center gap-2 bg-white/5 rounded-full px-4 py-1.5 border border-white/10">\
                        <button onclick="changeMonth(-1)" class="p-1 hover:text-fuchsia-400 transition-colors"><i class="fas fa-chevron-left"></i></button>\
                        <span id="current-month-display" class="w-32 text-center font-bold text-sm uppercase text-white tracking-widest">DECEMBRE</span>\
                        <button onclick="changeMonth(1)" class="p-1 hover:text-fuchsia-400 transition-colors"><i class="fas fa-chevron-right"></i></button>\
                    </div>\
                </div>\
            </header>\
            <div class="flex flex-1 overflow-hidden">\
                <div class="flex-1 overflow-auto flex" id="planning-container"></div>\
                <aside class="w-48 md:w-60 bg-[#0c0c10]/90 border-l border-white/10 p-5 overflow-y-auto hidden lg:block shadow-2xl z-20 backdrop-blur-md">\
                     <h3 class="text-gray-400 text-xs font-bold uppercase tracking-widest mb-6 text-center border-b border-white/10 pb-2">Artistes</h3>\
                     <div id="artist-sidebar-content"></div>\
                </aside>\
            </div>\
        </section>\
\
        <!-- SET LISTE (Publique) -->\
        <section id="setlist" class="page-section h-full w-full absolute inset-0 hidden overflow-y-auto p-4 md:p-10 fade-in z-10">\
            <div class="flex items-center mb-8 pt-2">\
                <h2 class="text-4xl md:text-6xl font-black text-white uppercase tracking-tighter">Set <span class="text-fuchsia-500 underline decoration-4 underline-offset-8">Liste</span></h2>\
            </div>\
            <!-- Conteneur g\'e9n\'e9r\'e9 dynamiquement -->\
            <div id="setlist-public-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 pb-20">\
                <!-- JS va injecter les colonnes ici -->\
            </div>\
        </section>\
\
        <!-- ADMIN PANEL (Cach\'e9) -->\
        <section id="admin-panel" class="page-section h-full w-full absolute inset-0 hidden overflow-y-auto p-8 fade-in z-20 bg-[#120a1f]">\
            <header class="flex justify-between items-center mb-10 border-b border-white/10 pb-6">\
                <h2 class="text-4xl text-white font-black uppercase tracking-tighter"><i class="fas fa-cogs text-red-500 mr-4"></i>Administration</h2>\
                <button onclick="saveAllData()" class="bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-full uppercase tracking-wider shadow-lg transform hover:scale-105 transition-all">\
                    <i class="fas fa-save mr-2"></i> Enregistrer Tout\
                </button>\
            </header>\
\
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-12">\
                <!-- GESTION EQUIPE (Gauche) -->\
                <div class="lg:col-span-5 bg-white/5 p-6 rounded-2xl border border-white/10">\
                    <h3 class="text-xl font-bold text-fuchsia-400 uppercase mb-6 flex items-center gap-2">\
                        <i class="fas fa-users"></i> Gestion de l'\'e9quipe\
                    </h3>\
                    \
                    <!-- Ajout -->\
                    <div class="bg-black/40 p-4 rounded-xl mb-6 border border-white/5">\
                        <div class="grid grid-cols-2 gap-2 mb-2">\
                            <div>\
                                <label class="text-[10px] text-gray-500 uppercase font-bold">Nom</label>\
                                <input type="text" id="new-artist-name" placeholder="NOM" class="w-full bg-white/10 border border-white/10 rounded p-2 text-white text-xs font-bold uppercase focus:border-fuchsia-500 outline-none">\
                            </div>\
                            <div>\
                                <label class="text-[10px] text-gray-500 uppercase font-bold">R\'f4le</label>\
                                <select id="new-artist-role" onchange="updateColorPicker()" class="w-full bg-white/10 border border-white/10 rounded p-2 text-white text-xs font-bold uppercase focus:border-fuchsia-500 outline-none">\
                                    <option value="chant">CHANT</option>\
                                    <option value="piano">PIANO</option>\
                                    <option value="basse">BASSE</option>\
                                    <option value="drum">DRUM</option>\
                                </select>\
                            </div>\
                        </div>\
                        \
                        <!-- NOUVEAU : S\'c9LECTEUR DE COULEUR VISUEL -->\
                        <div class="mb-4">\
                            <label class="text-[10px] text-gray-500 uppercase font-bold">Choisir la couleur</label>\
                            <div id="new-artist-color-picker" class="flex flex-wrap gap-2 mt-2 p-2 bg-black/50 rounded border border-white/5 min-h-[40px]">\
                                <!-- Gener\'e9 par JS -->\
                            </div>\
                            <p class="text-[10px] text-gray-500 italic mt-1">* Les couleurs gris\'e9es sont d\'e9j\'e0 utilis\'e9es par ce groupe</p>\
                        </div>\
                        \
                        <input type="hidden" id="selected-color-value">\
\
                        <button onclick="addNewArtist()" class="w-full bg-fuchsia-600 hover:bg-fuchsia-500 py-2 rounded text-white text-xs font-bold uppercase transition-colors"><i class="fas fa-plus"></i> Ajouter</button>\
                    </div>\
\
                    <!-- Liste -->\
                    <div class="h-[400px] overflow-y-auto custom-scrollbar pr-2" id="admin-team-list">\
                        <!-- Liste g\'e9n\'e9r\'e9e par JS -->\
                    </div>\
                </div>\
\
                <!-- GESTION SETLISTS (Droite) -->\
                <div class="lg:col-span-7 bg-white/5 p-6 rounded-2xl border border-white/10">\
                    <h3 class="text-xl font-bold text-blue-400 uppercase mb-6 flex items-center gap-2">\
                        <i class="fas fa-list-ol"></i> \'c9dition des Setlists\
                    </h3>\
                    <p class="text-xs text-gray-400 mb-4 bg-black/30 p-2 rounded"><i class="fas fa-info-circle mr-1"></i> Copiez-collez vos titres simplement (un par ligne). Pour cr\'e9er un sous-titre (ex: "SET 2"), \'e9crivez-le en majuscules.</p>\
\
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">\
                        <!-- Mercredi -->\
                        <div>\
                            <div class="flex justify-between mb-1">\
                                <label class="text-xs font-bold text-blue-300">MERCREDI</label>\
                                <input type="text" id="date-wed" class="bg-transparent border-none text-right text-xs text-gray-500 w-24" placeholder="Date...">\
                            </div>\
                            <textarea id="setlist-wed" class="admin-textarea w-full h-64 rounded-lg p-3 resize-none" placeholder="Liste Mercredi..."></textarea>\
                        </div>\
                        <!-- Jeudi -->\
                        <div>\
                            <div class="flex justify-between mb-1">\
                                <label class="text-xs font-bold text-purple-300">JEUDI</label>\
                                <input type="text" id="date-thu" class="bg-transparent border-none text-right text-xs text-gray-500 w-24" placeholder="Date...">\
                            </div>\
                            <textarea id="setlist-thu" class="admin-textarea w-full h-64 rounded-lg p-3 resize-none" placeholder="Liste Jeudi..."></textarea>\
                        </div>\
                        <!-- Vendredi -->\
                        <div>\
                            <div class="flex justify-between mb-1">\
                                <label class="text-xs font-bold text-pink-300">VENDREDI</label>\
                                <input type="text" id="date-fri" class="bg-transparent border-none text-right text-xs text-gray-500 w-24" placeholder="Date...">\
                            </div>\
                            <textarea id="setlist-fri" class="admin-textarea w-full h-64 rounded-lg p-3 resize-none" placeholder="Liste Vendredi..."></textarea>\
                        </div>\
                        <!-- Samedi -->\
                        <div>\
                            <div class="flex justify-between mb-1">\
                                <label class="text-xs font-bold text-indigo-300">SAMEDI</label>\
                                <input type="text" id="date-sat" class="bg-transparent border-none text-right text-xs text-gray-500 w-24" placeholder="Date...">\
                            </div>\
                            <textarea id="setlist-sat" class="admin-textarea w-full h-64 rounded-lg p-3 resize-none" placeholder="Liste Samedi..."></textarea>\
                        </div>\
                    </div>\
                </div>\
            </div>\
\
            <!-- GESTION BIBLIOTH\'c8QUE AUDIO -->\
            <div class="bg-white/5 p-6 rounded-2xl border border-white/10 w-full">\
                <h3 class="text-xl font-bold text-fuchsia-400 uppercase mb-6 flex items-center gap-2">\
                    <i class="fas fa-headphones"></i> Biblioth\'e8que Audio & Partitions\
                </h3>\
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">\
                    <!-- Formulaire (Gauche) -->\
                    <div class="lg:col-span-5 bg-black/40 p-6 rounded-xl border border-white/5">\
                        <input type="hidden" id="audio-id-input">\
                        <div class="mb-4">\
                            <label class="text-[10px] text-gray-500 uppercase font-bold">Titre du Morceau</label>\
                            <input type="text" id="audio-title-input" placeholder="EX: I WILL SURVIVE" class="w-full bg-white/10 border border-white/10 rounded p-2 text-white text-sm font-bold uppercase focus:border-fuchsia-500 outline-none">\
                        </div>\
                        \
                        <!-- UPLOAD MP3 -->\
                        <div class="mb-4">\
                            <label class="text-[10px] text-gray-500 uppercase font-bold">Fichier Audio (MP3)</label>\
                            <div class="flex gap-2">\
                                <input type="text" id="audio-src-input" placeholder="Lien URL ou Choisir fichier ->" class="flex-1 bg-white/5 border border-white/10 rounded p-2 text-fuchsia-300 text-xs font-mono focus:border-fuchsia-500 outline-none">\
                                <label class="cursor-pointer bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded text-xs font-bold flex items-center">\
                                    <i class="fas fa-folder-open"></i>\
                                    <input type="file" id="audio-file-upload" accept="audio/*" class="hidden" onchange="handleFileUpload(this, 'audio-src-input')">\
                                </label>\
                            </div>\
                        </div>\
\
                        <!-- UPLOAD PDFS -->\
                        <div class="grid grid-cols-2 gap-4 mb-4">\
                            <div>\
                                <label class="text-[10px] text-gray-500 uppercase font-bold">Paroles (PDF)</label>\
                                <div class="flex gap-1">\
                                    <input type="text" id="audio-lyrics-input" placeholder="Lien..." class="w-full bg-white/5 border border-white/10 rounded p-2 text-blue-300 text-xs font-mono focus:border-blue-500 outline-none">\
                                    <label class="cursor-pointer bg-gray-700 hover:bg-gray-600 px-2 py-2 rounded text-xs font-bold flex items-center">\
                                        <i class="fas fa-file-upload"></i>\
                                        <input type="file" accept="application/pdf" class="hidden" onchange="handleFileUpload(this, 'audio-lyrics-input')">\
                                    </label>\
                                </div>\
                            </div>\
                            <div>\
                                <label class="text-[10px] text-gray-500 uppercase font-bold">Partition (PDF)</label>\
                                <div class="flex gap-1">\
                                    <input type="text" id="audio-sheet-input" placeholder="Lien..." class="w-full bg-white/5 border border-white/10 rounded p-2 text-orange-300 text-xs font-mono focus:border-orange-500 outline-none">\
                                    <label class="cursor-pointer bg-gray-700 hover:bg-gray-600 px-2 py-2 rounded text-xs font-bold flex items-center">\
                                        <i class="fas fa-file-upload"></i>\
                                        <input type="file" accept="application/pdf" class="hidden" onchange="handleFileUpload(this, 'audio-sheet-input')">\
                                    </label>\
                                </div>\
                            </div>\
                        </div>\
                        <div class="mb-6">\
                            <label class="text-[10px] text-gray-500 uppercase font-bold">Lien YouTube (Chor\'e9)</label>\
                            <input type="text" id="audio-youtube-input" placeholder="https://youtube.com/..." class="w-full bg-white/5 border border-white/10 rounded p-2 text-red-300 text-xs font-mono focus:border-red-500 outline-none">\
                        </div>\
                        <div class="flex gap-2">\
                             <button onclick="saveAudioTrack()" class="flex-1 bg-fuchsia-600 hover:bg-fuchsia-500 py-3 rounded text-white text-xs font-bold uppercase transition-colors shadow-lg"><i class="fas fa-plus-circle mr-1"></i> Ajouter / Mettre \'e0 jour</button>\
                             <button onclick="clearAudioForm()" class="px-4 bg-gray-700 hover:bg-gray-600 rounded text-white text-xs font-bold uppercase transition-colors">Annuler</button>\
                        </div>\
                        <p class="text-[9px] text-red-400 mt-2 italic text-center">\uc0\u9888 \u65039  L'upload de fichiers peut saturer la m\'e9moire si le fichier est trop lourd.</p>\
                    </div>\
\
                    <!-- Liste (Droite) -->\
                    <div class="lg:col-span-7 h-[400px] overflow-y-auto custom-scrollbar bg-black/20 rounded-xl border border-white/5">\
                        <div id="admin-audio-list" class="p-2">\
                            <!-- G\'e9n\'e9r\'e9 par JS -->\
                        </div>\
                    </div>\
                </div>\
            </div>\
        </section>\
\
        <!-- AUDIO SECTION (PUBLIC) -->\
        <section id="audio" class="page-section h-full w-full absolute inset-0 hidden overflow-hidden fade-in z-10">\
            <div class="flex h-full">\
                <!-- Liste des titres (Gauche) -->\
                <div class="flex-1 flex flex-col p-8 overflow-hidden">\
                    <h2 class="text-4xl text-white mb-6 border-b border-gray-800 pb-4 font-black tracking-tighter">AUDIO <span class="text-fuchsia-500">PLAYER</span></h2>\
                    \
                    <!-- Search Bar -->\
                    <div class="mb-6 relative">\
                        <input type="text" id="audio-search" placeholder="RECHERCHER UN TITRE..." class="w-full bg-white/10 border border-white/20 rounded-full py-4 pl-14 pr-6 text-white text-lg font-bold tracking-wider focus:outline-none focus:border-fuchsia-500 transition-all uppercase placeholder-gray-500">\
                        <i class="fas fa-search absolute left-6 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl"></i>\
                    </div>\
\
                    <!-- Track List -->\
                    <div class="flex-1 overflow-y-auto custom-scrollbar pr-2" id="audio-track-list">\
                        <!-- List generated by JS -->\
                    </div>\
                </div>\
\
                <!-- Panneau Lat\'e9ral (Droite) -->\
                <div class="w-96 glass-panel h-full flex flex-col p-8 shadow-2xl z-20">\
                    <div id="player-empty-state" class="flex flex-col items-center justify-center h-full text-center opacity-50">\
                        <i class="fas fa-headphones text-6xl mb-4 text-fuchsia-500"></i>\
                        <p class="text-lg font-bold uppercase tracking-widest">S\'e9lectionnez<br>un titre</p>\
                    </div>\
\
                    <div id="player-content" class="hidden flex flex-col h-full">\
                        <h3 id="player-title" class="text-3xl font-black text-white uppercase tracking-tighter mb-2 leading-none break-words">TITRE</h3>\
                        <p class="text-xs font-bold text-fuchsia-400 uppercase tracking-[0.3em] mb-8">Lecteur Audio</p>\
\
                        <!-- Custom Controls -->\
                        <div class="bg-black/40 rounded-3xl p-6 mb-6 border border-white/10 shadow-[inset_0_2px_10px_rgba(0,0,0,0.5)]">\
                            <!-- Main Controls -->\
                            <div class="flex justify-center items-center gap-6 mb-6">\
                                <button onclick="stopAudio()" class="player-btn w-12 h-12 rounded-full bg-gray-800 text-white hover:bg-gray-700 flex items-center justify-center border border-white/10 shadow-lg">\
                                    <i class="fas fa-stop"></i>\
                                </button>\
                                <button onclick="togglePlay()" id="play-btn" class="player-btn w-20 h-20 rounded-full bg-fuchsia-600 text-white hover:bg-fuchsia-500 flex items-center justify-center border-4 border-[#1a0b2e] shadow-[0_0_30px_rgba(217,70,239,0.4)] transform hover:scale-105 transition-all">\
                                    <i class="fas fa-play text-2xl ml-1"></i>\
                                </button>\
                                <button onclick="resetAudio()" class="player-btn w-12 h-12 rounded-full bg-gray-800 text-white hover:bg-gray-700 flex items-center justify-center border border-white/10 shadow-lg">\
                                    <i class="fas fa-redo-alt"></i>\
                                </button>\
                            </div>\
                            \
                            <!-- Hidden Audio Element -->\
                            <audio id="audio-element" ontimeupdate="updateProgress()" onended="resetPlayerUI()"></audio>\
                            \
                            <!-- Progress Bar -->\
                            <div class="w-full bg-gray-900 rounded-full h-1.5 mb-2 overflow-hidden cursor-pointer" onclick="seekAudio(event)">\
                                <div id="progress-bar" class="bg-fuchsia-500 h-full w-0 transition-all duration-100"></div>\
                            </div>\
                            <div class="flex justify-between text-[9px] text-gray-500 font-mono mb-4">\
                                <span id="time-current">00:00</span>\
                                <span id="time-total">00:00</span>\
                            </div>\
\
                            <!-- Advanced Controls (Volume & Speed) -->\
                            <div class="flex items-center justify-between gap-4 border-t border-white/5 pt-4">\
                                <div class="flex items-center gap-2">\
                                    <i class="fas fa-volume-down text-gray-500 text-xs"></i>\
                                    <input type="range" min="0" max="1" step="0.1" value="1" onchange="setVolume(this.value)" class="w-20">\
                                </div>\
                                <div class="flex items-center gap-2">\
                                    <i class="fas fa-tachometer-alt text-gray-500 text-xs"></i>\
                                    <select onchange="setSpeed(this.value)" class="bg-black/50 border border-white/10 text-[9px] text-gray-300 rounded px-1 py-0.5 outline-none">\
                                        <option value="0.5">x0.5</option>\
                                        <option value="0.75">x0.75</option>\
                                        <option value="1" selected>x1.0</option>\
                                        <option value="1.25">x1.25</option>\
                                    </select>\
                                </div>\
                            </div>\
                        </div>\
\
                        <!-- Buttons Section -->\
                        <div class="grid grid-cols-2 gap-4 mb-4">\
                            <a id="btn-lyrics" href="#" class="flex flex-col items-center justify-center p-4 bg-blue-900/30 border border-blue-500/30 rounded-xl hover:bg-blue-900/50 transition-all group opacity-50 cursor-not-allowed">\
                                <i class="fas fa-file-pdf text-3xl mb-2 text-blue-400 group-hover:scale-110 transition-transform"></i>\
                                <span class="text-[10px] font-bold uppercase tracking-wider text-blue-200">Paroles</span>\
                            </a>\
                            <a id="btn-sheet" href="#" class="flex flex-col items-center justify-center p-4 bg-orange-900/30 border border-orange-500/30 rounded-xl hover:bg-orange-900/50 transition-all group opacity-50 cursor-not-allowed">\
                                <i class="fas fa-file-pdf text-3xl mb-2 text-orange-400 group-hover:scale-110 transition-transform"></i>\
                                <span class="text-[10px] font-bold uppercase tracking-wider text-orange-200">Partition</span>\
                            </a>\
                        </div>\
                        \
                        <a id="btn-youtube" href="#" target="_blank" class="w-full flex items-center justify-center gap-3 p-4 bg-red-900/30 border border-red-500/30 rounded-xl hover:bg-red-900/50 transition-all group opacity-50 cursor-not-allowed">\
                            <i class="fab fa-youtube text-3xl text-red-500 group-hover:scale-110 transition-transform"></i>\
                            <span class="text-xs font-bold uppercase tracking-wider text-white">Chor\'e9graphie</span>\
                        </a>\
\
                        <div class="mt-auto pt-6 text-center">\
                            <p class="text-[9px] text-gray-600 italic">Mondaine Artistes Intranet v2.4</p>\
                        </div>\
                    </div>\
                </div>\
            </div>\
        </section>\
\
    </main>\
\
    <!-- TOAST NOTIFICATION -->\
    <div id="toast-notification" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-8 py-4 rounded-full shadow-2xl z-[100] opacity-0 font-bold uppercase tracking-wider flex items-center gap-3 pointer-events-none">\
        <i class="fas fa-check-circle text-xl"></i>\
        <span>Enregistr\'e9 avec succ\'e8s</span>\
    </div>\
\
    <!-- ERROR TOAST -->\
    <div id="error-toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-8 py-4 rounded-full shadow-2xl z-[100] opacity-0 font-bold uppercase tracking-wider flex items-center gap-3 pointer-events-none transition-opacity duration-300">\
        <i class="fas fa-exclamation-circle text-xl"></i>\
        <span id="error-message">Erreur</span>\
    </div>\
\
    <!-- PASSWORD MODAL -->\
    <div id="password-modal" class="fixed inset-0 bg-black/95 z-[100] hidden flex items-center justify-center backdrop-blur-md">\
        <div class="bg-[#1a0b2e] border border-fuchsia-500/50 rounded-2xl p-8 w-80 shadow-[0_0_50px_rgba(168,85,247,0.5)] transform transition-all text-center">\
            <div class="mb-4"><i class="fas fa-lock text-4xl text-fuchsia-500 animate-pulse"></i></div>\
            <h3 class="text-white font-bold text-xl mb-4 tracking-wide uppercase">Acc\'e8s Admin</h3>\
            <input type="password" id="admin-pass-input" class="w-full bg-black/50 border border-gray-600 rounded p-3 text-center text-white text-lg tracking-[0.5em] mb-4 focus:border-fuchsia-500 focus:outline-none placeholder-gray-600" placeholder="\'95\'95\'95\'95">\
            <p id="pass-error" class="text-red-500 text-xs mb-3 hidden">Mot de passe incorrect</p>\
            <div class="grid grid-cols-2 gap-3">\
                <button onclick="closeModal('password-modal')" class="py-2 border border-gray-700 text-gray-400 rounded hover:bg-white/5 text-xs font-bold uppercase">Annuler</button>\
                <button onclick="checkAdminPassword()" class="py-2 bg-fuchsia-600 text-white rounded hover:bg-fuchsia-500 text-xs font-bold uppercase shadow-lg">Valider</button>\
            </div>\
        </div>\
    </div>\
\
    <!-- DELETE CONFIRMATION MODAL -->\
    <div id="delete-modal" class="fixed inset-0 bg-black/95 z-[100] hidden flex items-center justify-center backdrop-blur-md">\
        <div class="bg-[#1a0b2e] border border-red-500/50 rounded-2xl p-8 w-80 shadow-[0_0_50px_rgba(239,68,68,0.4)] transform transition-all text-center">\
            <div class="mb-4"><i class="fas fa-exclamation-triangle text-4xl text-red-500"></i></div>\
            <h3 class="text-white font-bold text-lg mb-2">Supprimer cet artiste ?</h3>\
            <p class="text-gray-400 text-xs mb-6">Cela ne l'effacera pas du planning d\'e9j\'e0 fait, mais vous ne pourrez plus l'assigner.</p>\
            <div class="grid grid-cols-2 gap-3">\
                <button onclick="closeModal('delete-modal')" class="py-2 border border-gray-700 text-gray-400 rounded hover:bg-white/5 text-xs font-bold uppercase">Annuler</button>\
                <button onclick="confirmDelete()" class="py-2 bg-red-600 text-white rounded hover:bg-red-500 text-xs font-bold uppercase shadow-lg">Supprimer</button>\
            </div>\
        </div>\
    </div>\
    \
    <!-- AUDIO DELETE MODAL -->\
    <div id="delete-audio-modal" class="fixed inset-0 bg-black/95 z-[100] hidden flex items-center justify-center backdrop-blur-md">\
        <div class="bg-[#1a0b2e] border border-red-500/50 rounded-2xl p-8 w-80 shadow-[0_0_50px_rgba(239,68,68,0.4)] transform transition-all text-center">\
            <div class="mb-4"><i class="fas fa-trash-alt text-4xl text-red-500"></i></div>\
            <h3 class="text-white font-bold text-lg mb-2">Supprimer ce titre ?</h3>\
            <p class="text-gray-400 text-xs mb-6">Attention, action irr\'e9versible.</p>\
            <div class="grid grid-cols-2 gap-3">\
                <button onclick="closeModal('delete-audio-modal')" class="py-2 border border-gray-700 text-gray-400 rounded hover:bg-white/5 text-xs font-bold uppercase">Annuler</button>\
                <button onclick="confirmDeleteAudio()" class="py-2 bg-red-600 text-white rounded hover:bg-red-500 text-xs font-bold uppercase shadow-lg">Supprimer</button>\
            </div>\
        </div>\
    </div>\
\
    <!-- ASSIGN MODAL (Planning) -->\
    <div id="assign-modal" class="fixed inset-0 bg-black/90 z-50 hidden flex items-center justify-center backdrop-blur-sm">\
        <div class="bg-[#1a0b2e] border border-fuchsia-500/30 rounded-2xl p-6 w-80 shadow-[0_0_50px_rgba(168,85,247,0.3)] transform transition-all">\
            <div class="flex justify-between items-center mb-4 border-b border-white/10 pb-2">\
                <h3 class="text-white font-bold tracking-wide">Assigner un artiste</h3>\
                <button onclick="closeModal('assign-modal')" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>\
            </div>\
            <div class="mb-4 text-xs text-fuchsia-400 uppercase font-bold tracking-widest" id="modal-slot-info">Date - Slot</div>\
            <div id="modal-artist-list" class="grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1 custom-scrollbar"></div>\
            <button onclick="removeAssignment()" class="w-full mt-6 py-3 border border-red-500/50 text-red-400 rounded-lg hover:bg-red-500/10 text-xs font-bold uppercase tracking-wider transition-colors">\
                <i class="fas fa-trash mr-2"></i> Retirer l'assignation\
            </button>\
        </div>\
    </div>\
\
    <script>\
        // --- HELPER SIDEBAR ---\
        function toggleSidebar() \{\
            const sidebar = document.getElementById('main-sidebar');\
            const icon = document.getElementById('sidebar-icon');\
            \
            sidebar.classList.toggle('sidebar-collapsed');\
            \
            // Change Icon\
            if(sidebar.classList.contains('sidebar-collapsed')) \{\
                icon.classList.remove('fa-compress-alt');\
                icon.classList.add('fa-expand-alt');\
            \} else \{\
                icon.classList.remove('fa-expand-alt');\
                icon.classList.add('fa-compress-alt');\
            \}\
        \}\
\
        // --- HELPER PDF ---\
        function openPdfViewer(content) \{\
            if (!content) return;\
\
            // 1. Si c'est un lien externe (http/https)\
            if (content.startsWith('http')) \{\
                window.open(content, '_blank');\
                return;\
            \}\
\
            // 2. Si c'est un Data URI (Fichier upload\'e9)\
            if (content.startsWith('data:application/pdf')) \{\
                try \{\
                    // Conversion Data URI -> Blob pour contourner la s\'e9curit\'e9 Chrome\
                    const arr = content.split(',');\
                    const mime = arr[0].match(/:(.*?);/)[1];\
                    const bstr = atob(arr[1]);\
                    let n = bstr.length;\
                    const u8arr = new Uint8Array(n);\
                    while (n--) \{\
                        u8arr[n] = bstr.charCodeAt(n);\
                    \}\
                    const blob = new Blob([u8arr], \{ type: mime \});\
                    const blobUrl = URL.createObjectURL(blob);\
                    \
                    // Ouverture du Blob URL\
                    window.open(blobUrl, '_blank');\
                \} catch (e) \{\
                    console.error("Erreur conversion PDF", e);\
                    // Fallback iframe si la conversion \'e9choue\
                    const win = window.open();\
                    if(win) \{\
                        win.document.write('<iframe src="' + content + '" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>');\
                        win.document.title = "PDF Viewer";\
                    \} else \{\
                        alert("Pop-up bloqu\'e9. Veuillez autoriser les pop-ups pour voir le PDF.");\
                    \}\
                \}\
            \} else \{\
                // Autres formats\
                window.open(content, '_blank');\
            \}\
        \}\
        \
        // --- CONFIGURATION DES COULEURS ETENDUES ---\
        const COLOR_PALETTES = \{\
            singers: [\
                'bg-fuchsia-500 text-white', 'bg-pink-500 text-white', 'bg-rose-500 text-white',\
                'bg-red-500 text-white', 'bg-orange-500 text-white', 'bg-amber-400 text-black',\
                'bg-yellow-400 text-black', 'bg-lime-400 text-black', 'bg-green-500 text-white',\
                'bg-emerald-400 text-black', 'bg-teal-400 text-black', 'bg-cyan-400 text-black',\
                'bg-sky-500 text-white', 'bg-blue-500 text-white', 'bg-indigo-500 text-white',\
                'bg-violet-500 text-white', 'bg-purple-500 text-white',\
                'bg-red-200 text-red-900', 'bg-orange-200 text-orange-900', 'bg-amber-200 text-amber-900',\
                'bg-yellow-200 text-yellow-900', 'bg-lime-200 text-lime-900', 'bg-green-200 text-green-900',\
                'bg-emerald-200 text-emerald-900', 'bg-teal-200 text-teal-900', 'bg-cyan-200 text-cyan-900',\
                'bg-sky-200 text-sky-900', 'bg-blue-200 text-blue-900', 'bg-indigo-200 text-indigo-900',\
                'bg-violet-200 text-violet-900', 'bg-purple-200 text-purple-900', 'bg-fuchsia-200 text-fuchsia-900',\
                'bg-pink-200 text-pink-900', 'bg-rose-200 text-rose-900'\
            ],\
            piano: [\
                'bg-green-600 text-white', 'bg-emerald-700 text-white', 'bg-lime-700 text-white',\
                'bg-green-800 text-white', 'bg-teal-800 text-white', 'bg-stone-600 text-white',\
                'bg-stone-500 text-white', 'bg-amber-900 text-white', 'bg-yellow-800 text-white',\
                'bg-lime-900 text-white', 'bg-green-900 text-white', 'bg-emerald-900 text-white'\
            ],\
            basse: [\
                 'bg-blue-600 text-white', 'bg-indigo-600 text-white', 'bg-violet-600 text-white',\
                 'bg-blue-800 text-white', 'bg-indigo-800 text-white', 'bg-violet-800 text-white',\
                 'bg-sky-700 text-white', 'bg-cyan-800 text-white', 'bg-slate-700 text-white',\
                 'bg-blue-900 text-white', 'bg-indigo-900 text-white', 'bg-purple-900 text-white'\
            ],\
            drum: [\
                'bg-yellow-500 text-black', 'bg-amber-500 text-black', 'bg-orange-500 text-white',\
                'bg-red-500 text-white', 'bg-orange-600 text-white', 'bg-red-600 text-white',\
                'bg-yellow-600 text-black', 'bg-amber-600 text-white', 'bg-rose-600 text-white',\
                'bg-orange-700 text-white', 'bg-red-700 text-white', 'bg-rose-700 text-white'\
            ]\
        \};\
\
        const DEFAULT_ARTISTS = [\
            \{ id: '1', name: 'JULIA', color: 'bg-fuchsia-500 text-white', group: 'chant' \},\
            \{ id: '2', name: 'MARION', color: 'bg-orange-500 text-white', group: 'chant' \},\
            \{ id: '3', name: 'L\'c9A', color: 'bg-green-500 text-white', group: 'chant' \},\
            \{ id: '11', name: 'MAT L', color: 'bg-green-700 text-white', group: 'musicien', role: 'piano' \},\
            \{ id: '13', name: 'JAN', color: 'bg-yellow-600 text-black', group: 'musicien', role: 'basse' \},\
            \{ id: '15', name: 'XAVIER', color: 'bg-blue-700 text-white', group: 'musicien', role: 'basse' \},\
            \{ id: '17', name: 'NICO', color: 'bg-red-700 text-white', group: 'musicien', role: 'drum' \}\
        ];\
        \
        const DEFAULT_SETLISTS = \{\
            wed: \{ date: "Mercredi 03 Dec", content: "Big Spender\\nFlowers\\nTab The Verve\\nLes Femmes \'e7a fait PD\\nSomething's Got" \},\
            thu: \{ date: "Jeudi 04 Dec", content: "Besoin d'Amour\\nMedley Seven Nation\\nSave Your Tears\\nI Will Survive" \},\
            fri: \{ date: "Vendredi 05 Dec", content: "I Will Survive\\nI Follow Rivers\\nValerie\\nTreasure" \},\
            sat: \{ date: "Samedi 06 Dec", content: "Uptown Funk\\nGet Lucky\\nLevitating\\nDon't Start Now" \}\
        \};\
\
        const DEFAULT_AUDIO = [\
            \{ id: 't1', title: 'BIG SPENDER', src: '', lyrics: '', sheet: '', youtube: 'https://youtube.com' \},\
            \{ id: 't2', title: 'FLOWERS', src: '', lyrics: '', sheet: '', youtube: '' \},\
            \{ id: 't3', title: 'TAB THE VERVE', src: '', lyrics: '', sheet: '', youtube: '' \},\
            \{ id: 't9', title: 'I WILL SURVIVE', src: '', lyrics: '', sheet: '', youtube: '' \},\
            \{ id: 't13', title: 'UPTOWN FUNK', src: '', lyrics: '', sheet: '', youtube: '' \}\
        ];\
\
        let ARTISTS = [];\
        let assignments = \{\};\
        let SETLISTS = \{\};\
        let AUDIO_LIBRARY = [];\
        let artistToDeleteId = null;\
        let audioToDeleteId = null;\
\
        function loadData() \{\
            try \{\
                const storedArtists = localStorage.getItem('mondaine_artists');\
                const storedPlanning = localStorage.getItem('mondaine_planning');\
                const storedSetlists = localStorage.getItem('mondaine_setlists');\
                const storedAudio = localStorage.getItem('mondaine_audio_library');\
                \
                ARTISTS = storedArtists ? JSON.parse(storedArtists) : DEFAULT_ARTISTS;\
                assignments = storedPlanning ? JSON.parse(storedPlanning) : \{\};\
                SETLISTS = storedSetlists ? JSON.parse(storedSetlists) : DEFAULT_SETLISTS;\
                AUDIO_LIBRARY = storedAudio ? JSON.parse(storedAudio) : DEFAULT_AUDIO;\
            \} catch (e) \{\
                console.error("Erreur chargement", e);\
                ARTISTS = DEFAULT_ARTISTS;\
                assignments = \{\};\
                SETLISTS = DEFAULT_SETLISTS;\
                AUDIO_LIBRARY = DEFAULT_AUDIO;\
            \}\
        \}\
\
        function saveAllData() \{\
            SETLISTS.wed.date = document.getElementById('date-wed').value;\
            SETLISTS.wed.content = document.getElementById('setlist-wed').value;\
            SETLISTS.thu.date = document.getElementById('date-thu').value;\
            SETLISTS.thu.content = document.getElementById('setlist-thu').value;\
            SETLISTS.fri.date = document.getElementById('date-fri').value;\
            SETLISTS.fri.content = document.getElementById('setlist-fri').value;\
            SETLISTS.sat.date = document.getElementById('date-sat').value;\
            SETLISTS.sat.content = document.getElementById('setlist-sat').value;\
\
            localStorage.setItem('mondaine_artists', JSON.stringify(ARTISTS));\
            localStorage.setItem('mondaine_planning', JSON.stringify(assignments));\
            localStorage.setItem('mondaine_setlists', JSON.stringify(SETLISTS));\
            try \{\
                 localStorage.setItem('mondaine_audio_library', JSON.stringify(AUDIO_LIBRARY));\
                 showToast();\
            \} catch (e) \{\
                console.error("Quota Exceeded for Audio Library");\
                showErrorToast("Fichiers trop lourds pour la sauvegarde navigateur. Ils sont dispo pour la session en cours seulement.");\
            \}\
            \
            renderSetlistPublic();\
        \}\
\
        function showToast() \{\
            const toast = document.getElementById('toast-notification');\
            toast.classList.remove('toast-visible');\
            void toast.offsetWidth; \
            toast.classList.add('toast-visible');\
        \}\
        \
        function showErrorToast(msg) \{\
            const toast = document.getElementById('error-toast');\
            document.getElementById('error-message').innerText = msg;\
            toast.classList.remove('opacity-0', 'pointer-events-none');\
            setTimeout(() => \{\
                toast.classList.add('opacity-0', 'pointer-events-none');\
            \}, 5000);\
        \}\
\
        let isAdminMode = false;\
        let currentDate = new Date(2025, 11, 1); \
        let selectedArtistId = null;\
        let currentEditSlot = null;\
\
        function showPage(pageId) \{\
            document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));\
            document.getElementById(pageId).classList.remove('hidden');\
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active', 'text-fuchsia-400'));\
            const activeLink = document.getElementById('nav-' + pageId);\
            if(activeLink) activeLink.classList.add('active');\
\
            if(pageId === 'planning') renderPlanning();\
            if(pageId === 'setlist') renderSetlistPublic();\
            if(pageId === 'audio') renderAudioList(); \
            if(pageId === 'admin-panel') \{\
                loadAdminValues();\
                updateColorPicker(); \
            \}\
        \}\
\
        // --- AUTH & ADMIN ---\
        function toggleAdminMode() \{\
            if(!isAdminMode) \{\
                document.getElementById('password-modal').classList.remove('hidden');\
                document.getElementById('admin-pass-input').value = '';\
                document.getElementById('pass-error').classList.add('hidden');\
                document.getElementById('admin-pass-input').focus();\
            \} else \{\
                isAdminMode = false;\
                updateAdminUI();\
            \}\
        \}\
\
        function checkAdminPassword() \{\
            const pass = document.getElementById('admin-pass-input').value;\
            if(pass === "mondaine") \{\
                isAdminMode = true;\
                closeModal('password-modal');\
                updateAdminUI();\
            \} else \{\
                document.getElementById('pass-error').classList.remove('hidden');\
            \}\
        \}\
        document.getElementById('admin-pass-input').addEventListener('keypress', (e) => \{ if(e.key === 'Enter') checkAdminPassword(); \});\
\
        function updateAdminUI() \{\
            const btn = document.getElementById('admin-toggle-btn');\
            const icon = btn.querySelector('i');\
            const navItem = document.getElementById('admin-nav-item');\
\
            if(isAdminMode) \{\
                btn.classList.add('text-fuchsia-500');\
                icon.classList.remove('fa-lock');\
                icon.classList.add('fa-unlock');\
                navItem.classList.remove('hidden'); \
            \} else \{\
                btn.classList.remove('text-fuchsia-500');\
                icon.classList.add('fa-lock');\
                icon.classList.remove('fa-unlock');\
                navItem.classList.add('hidden'); \
                if(!document.getElementById('admin-panel').classList.contains('hidden')) showPage('home');\
            \}\
            renderPlanning();\
        \}\
\
        function loadAdminValues() \{\
            document.getElementById('date-wed').value = SETLISTS.wed.date;\
            document.getElementById('setlist-wed').value = SETLISTS.wed.content;\
            document.getElementById('date-thu').value = SETLISTS.thu.date;\
            document.getElementById('setlist-thu').value = SETLISTS.thu.content;\
            document.getElementById('date-fri').value = SETLISTS.fri.date;\
            document.getElementById('setlist-fri').value = SETLISTS.fri.content;\
            document.getElementById('date-sat').value = SETLISTS.sat.date;\
            document.getElementById('setlist-sat').value = SETLISTS.sat.content;\
            renderAdminTeamList();\
            renderAdminAudioList(); \
        \}\
\
        // --- AUDIO ADMIN LOGIC ---\
        function handleFileUpload(input, targetId) \{\
            const file = input.files[0];\
            if (!file) return;\
\
            const reader = new FileReader();\
            reader.onload = function(e) \{\
                document.getElementById(targetId).value = e.target.result;\
                // Visual feedback\
                const parent = input.parentElement;\
                parent.classList.remove('bg-gray-700', 'hover:bg-gray-600');\
                parent.classList.add('bg-green-600', 'hover:bg-green-500');\
            \};\
            \
            // Limit size check (approx 4MB)\
            if(file.size > 4000000) \{\
                alert("Attention : ce fichier est volumineux (" + (file.size/1000000).toFixed(2) + "MB). La sauvegarde risque d'\'e9chouer.");\
            \}\
            \
            reader.readAsDataURL(file);\
        \}\
\
        function renderAdminAudioList() \{\
            const container = document.getElementById('admin-audio-list');\
            const sortedAudio = [...AUDIO_LIBRARY].sort((a, b) => a.title.localeCompare(b.title));\
            \
            if(sortedAudio.length === 0) \{\
                container.innerHTML = `<p class="text-gray-500 text-center italic text-xs mt-4">Aucun titre. Ajoutez-en un !</p>`;\
                return;\
            \}\
\
            container.innerHTML = sortedAudio.map(track => `\
                <div class="flex items-center justify-between bg-white/5 p-3 rounded mb-2 hover:bg-white/10 transition-colors">\
                    <div class="truncate flex-1 pr-4">\
                        <div class="text-xs font-bold text-white uppercase">$\{track.title\}</div>\
                        <div class="text-[9px] text-gray-500 font-mono truncate">$\{track.src ? 'Audio OK' : 'Pas d\\'audio'\} \'95 $\{track.lyrics ? 'Paroles OK' : ''\}</div>\
                    </div>\
                    <div class="flex gap-2">\
                        <button onclick="editAudioTrack('$\{track.id\}')" class="text-blue-400 hover:text-blue-300 p-2"><i class="fas fa-edit"></i></button>\
                        <button onclick="askDeleteAudio('$\{track.id\}')" class="text-red-400 hover:text-red-300 p-2"><i class="fas fa-trash"></i></button>\
                    </div>\
                </div>\
            `).join('');\
        \}\
\
        function saveAudioTrack() \{\
            const idInput = document.getElementById('audio-id-input').value;\
            const title = document.getElementById('audio-title-input').value.trim().toUpperCase();\
            \
            if(!title) return alert("Le titre est obligatoire");\
\
            const newTrack = \{\
                id: idInput || Date.now().toString(),\
                title: title,\
                src: document.getElementById('audio-src-input').value.trim(),\
                lyrics: document.getElementById('audio-lyrics-input').value.trim(),\
                sheet: document.getElementById('audio-sheet-input').value.trim(),\
                youtube: document.getElementById('audio-youtube-input').value.trim()\
            \};\
\
            if(idInput) \{\
                const index = AUDIO_LIBRARY.findIndex(t => t.id === idInput);\
                if(index !== -1) AUDIO_LIBRARY[index] = newTrack;\
            \} else \{\
                AUDIO_LIBRARY.push(newTrack);\
            \}\
\
            try \{\
                localStorage.setItem('mondaine_audio_library', JSON.stringify(AUDIO_LIBRARY));\
                showToast();\
            \} catch (e) \{\
                console.error("Quota Exceeded");\
                showErrorToast("Fichiers trop lourds. Sauvegarde locale annul\'e9e, mais disponible pour la session.");\
            \}\
            \
            renderAdminAudioList();\
            clearAudioForm();\
        \}\
\
        function editAudioTrack(id) \{\
            const track = AUDIO_LIBRARY.find(t => t.id === id);\
            if(!track) return;\
            \
            document.getElementById('audio-id-input').value = track.id;\
            document.getElementById('audio-title-input').value = track.title;\
            document.getElementById('audio-src-input').value = track.src;\
            document.getElementById('audio-lyrics-input').value = track.lyrics;\
            document.getElementById('audio-sheet-input').value = track.sheet;\
            document.getElementById('audio-youtube-input').value = track.youtube;\
        \}\
\
        function clearAudioForm() \{\
            document.getElementById('audio-id-input').value = '';\
            document.getElementById('audio-title-input').value = '';\
            document.getElementById('audio-src-input').value = '';\
            document.getElementById('audio-lyrics-input').value = '';\
            document.getElementById('audio-sheet-input').value = '';\
            document.getElementById('audio-youtube-input').value = '';\
            \
            document.querySelectorAll('input[type="file"]').forEach(input => \{\
                input.value = '';\
                input.parentElement.classList.remove('bg-green-600', 'hover:bg-green-500');\
                input.parentElement.classList.add('bg-gray-700', 'hover:bg-gray-600');\
            \});\
        \}\
\
        function askDeleteAudio(id) \{\
            audioToDeleteId = id;\
            document.getElementById('delete-audio-modal').classList.remove('hidden');\
        \}\
        \
        function confirmDeleteAudio() \{\
             if(audioToDeleteId) \{\
                AUDIO_LIBRARY = AUDIO_LIBRARY.filter(t => t.id !== audioToDeleteId);\
                localStorage.setItem('mondaine_audio_library', JSON.stringify(AUDIO_LIBRARY));\
                renderAdminAudioList();\
                audioToDeleteId = null;\
                closeModal('delete-audio-modal');\
            \}\
        \}\
\
\
        // --- PUBLIC AUDIO PAGE LOGIC ---\
        function renderSetlistPublic() \{\
            const container = document.getElementById('setlist-public-container');\
            const days = [\
                \{ id: 'wed', color: 'blue', data: SETLISTS.wed \},\
                \{ id: 'thu', color: 'purple', data: SETLISTS.thu \},\
                \{ id: 'fri', color: 'pink', data: SETLISTS.fri \},\
                \{ id: 'sat', color: 'indigo', data: SETLISTS.sat \}\
            ];\
\
            container.innerHTML = days.map(day => \{\
                const lines = day.data.content.split('\\n').filter(l => l.trim() !== '');\
                const listHTML = lines.map(line => \{\
                    if(line.toUpperCase().includes('SET ') || line === line.toUpperCase()) \{\
                         return `<p class="text-$\{day.color\}-400 font-bold text-xs uppercase underline mt-4 mb-2 tracking-widest">$\{line\}</p>`;\
                    \}\
                    return `<li class="ml-4">$\{line\}</li>`;\
                \}).join('');\
\
                return `\
                <div class="bg-$\{day.color\}-900/10 border border-$\{day.color\}-500/30 p-0 rounded-3xl overflow-hidden shadow-[0_0_30px_rgba(0,0,0,0.2)] flex flex-col h-full">\
                    <div class="header-$\{day.color\} text-white py-4 text-center font-bold uppercase text-sm md:text-base tracking-wider shadow-lg">\
                        $\{day.data.date\}\
                    </div>\
                    <div class="p-6 text-sm text-gray-200 flex-1">\
                        <ul class="list-disc list-outside space-y-2 text-xs md:text-sm font-medium opacity-90">\
                            $\{listHTML || '<li class="italic text-gray-500 list-none">Aucune chanson</li>'\}\
                        </ul>\
                    </div>\
                </div>`;\
            \}).join('');\
        \}\
\
        // --- AUDIO PLAYER LOGIC ---\
        let currentTrack = null;\
        let audio = document.getElementById('audio-element');\
\
        function renderAudioList(searchTerm = '') \{\
            const container = document.getElementById('audio-track-list');\
            const searchNormalized = searchTerm.toLowerCase();\
            const filteredTracks = AUDIO_LIBRARY.filter(t => t.title.toLowerCase().includes(searchNormalized))\
                                                .sort((a, b) => a.title.localeCompare(b.title));\
            \
            if(filteredTracks.length === 0) \{\
                 container.innerHTML = `<div class="text-gray-500 text-center italic mt-10">Aucun titre trouv\'e9.<br>Ajoutez-en via l'Administration.</div>`;\
                 return;\
            \}\
\
            container.innerHTML = filteredTracks.map(track => \{\
                const isActive = currentTrack && currentTrack.id === track.id ? 'active' : '';\
                return `\
                <button onclick="selectTrack('$\{track.id\}')" class="track-item w-full text-left py-3 px-4 border-b border-white/5 text-gray-300 font-bold uppercase hover:text-white flex items-center justify-between group $\{isActive\}">\
                    <span>$\{track.title\}</span>\
                    <i class="fas fa-play text-xs opacity-0 group-hover:opacity-50 text-fuchsia-500 transition-opacity"></i>\
                </button>\
                `;\
            \}).join('');\
        \}\
        \
        document.getElementById('audio-search').addEventListener('input', (e) => \{\
            renderAudioList(e.target.value);\
        \});\
\
        function selectTrack(trackId) \{\
            currentTrack = AUDIO_LIBRARY.find(t => t.id === trackId);\
            renderAudioList(document.getElementById('audio-search').value);\
            \
            document.getElementById('player-empty-state').classList.add('hidden');\
            document.getElementById('player-content').classList.remove('hidden');\
            document.getElementById('player-title').innerText = currentTrack.title;\
            \
            updateButtonState('btn-lyrics', currentTrack.lyrics);\
            updateButtonState('btn-sheet', currentTrack.sheet);\
            updateButtonState('btn-youtube', currentTrack.youtube);\
\
            if(currentTrack.src) \{\
                audio.src = currentTrack.src;\
                audio.playbackRate = 1;\
                audio.volume = 1;\
                document.querySelector('select').value = "1";\
                document.querySelector('input[type=range]').value = "1";\
            \} else \{\
                audio.src = "";\
                resetPlayerUI();\
            \}\
        \}\
        \
        function updateButtonState(btnId, link) \{\
            const btn = document.getElementById(btnId);\
            \
            // On retire les anciens \'e9couteurs via clonage ou simple r\'e9affectation si propre\
            // Ici, on \'e9crase onclick\
            btn.onclick = null;\
\
            if(link) \{\
                btn.classList.remove('opacity-50', 'cursor-not-allowed');\
                btn.classList.add('opacity-100', 'cursor-pointer');\
                \
                // Gestionnaire sp\'e9cial pour les PDF Data URI\
                btn.onclick = (e) => \{\
                    if (link.startsWith('data:')) \{\
                        e.preventDefault();\
                        openPdfViewer(link);\
                    \} else \{\
                        // Comportement normal pour liens externes\
                        // Laisser le <a target="_blank"> faire son travail\
                    \}\
                \};\
                \
                if (!link.startsWith('data:')) \{\
                    btn.href = link;\
                \} else \{\
                    btn.href = "#";\
                \}\
\
            \} else \{\
                btn.href = '#';\
                btn.classList.add('opacity-50', 'cursor-not-allowed');\
                btn.classList.remove('opacity-100', 'cursor-pointer');\
                btn.onclick = (e) => e.preventDefault();\
            \}\
        \}\
\
        // Controls\
        function togglePlay() \{\
            const btn = document.getElementById('play-btn');\
            const icon = btn.querySelector('i');\
            \
            if(audio.paused) \{\
                if(audio.src) \{\
                    audio.play();\
                    icon.classList.remove('fa-play');\
                    icon.classList.add('fa-pause');\
                \}\
            \} else \{\
                audio.pause();\
                icon.classList.remove('fa-pause');\
                icon.classList.add('fa-play');\
            \}\
        \}\
\
        function stopAudio() \{\
            audio.pause();\
            audio.currentTime = 0;\
            resetPlayerUI();\
        \}\
        \
        function resetAudio() \{\
             audio.currentTime = 0;\
             if(!audio.paused) audio.play();\
        \}\
\
        function setVolume(val) \{\
            audio.volume = val;\
        \}\
\
        function setSpeed(val) \{\
            audio.playbackRate = val;\
        \}\
\
        function seekAudio(event) \{\
            if(audio.duration) \{\
                const progressBarContainer = event.currentTarget;\
                const clickPosition = event.offsetX;\
                const totalWidth = progressBarContainer.clientWidth;\
                const percentage = clickPosition / totalWidth;\
                audio.currentTime = percentage * audio.duration;\
            \}\
        \}\
\
        function resetPlayerUI() \{\
            const btn = document.getElementById('play-btn');\
            const icon = btn.querySelector('i');\
            icon.classList.remove('fa-pause');\
            icon.classList.add('fa-play');\
            document.getElementById('progress-bar').style.width = '0%';\
        \}\
\
        function updateProgress() \{\
            const progressBar = document.getElementById('progress-bar');\
            const timeCurrent = document.getElementById('time-current');\
            const timeTotal = document.getElementById('time-total');\
\
            if(audio.duration) \{\
                const percent = (audio.currentTime / audio.duration) * 100;\
                progressBar.style.width = `$\{percent\}%`;\
                \
                timeCurrent.innerText = formatTime(audio.currentTime);\
                timeTotal.innerText = formatTime(audio.duration);\
            \}\
        \}\
\
        function formatTime(seconds) \{\
            if (!seconds || isNaN(seconds)) return "00:00";\
            const min = Math.floor(seconds / 60);\
            const sec = Math.floor(seconds % 60);\
            return `$\{min.toString().padStart(2, '0')\}:$\{sec.toString().padStart(2, '0')\}`;\
        \}\
        \
        function updateColorPicker() \{\
            const role = document.getElementById('new-artist-role').value;\
            const container = document.getElementById('new-artist-color-picker');\
            const hiddenInput = document.getElementById('selected-color-value');\
            \
            let palette;\
            if (role === 'chant') palette = COLOR_PALETTES.singers;\
            else if (role === 'piano') palette = COLOR_PALETTES.piano;\
            else if (role === 'basse') palette = COLOR_PALETTES.basse;\
            else if (role === 'drum') palette = COLOR_PALETTES.drum;\
            else palette = COLOR_PALETTES.musicians; \
            \
            const groupType = (role === 'chant') ? 'chant' : 'musicien';\
            const usedColors = ARTISTS\
                .filter(a => a.group === groupType && (groupType === 'chant' || a.role === role))\
                .map(a => a.color);\
\
            let html = '';\
            let firstFreeColor = null;\
\
            palette.forEach(colorClass => \{\
                const isUsed = usedColors.includes(colorClass);\
                const usedClass = isUsed ? 'used' : '';\
                \
                if(!firstFreeColor && !isUsed) firstFreeColor = colorClass;\
                \
                html += `<div class="color-swatch $\{colorClass\} $\{usedClass\}" onclick="selectColor(this, '$\{colorClass\}')"></div>`;\
            \});\
            \
            container.innerHTML = html;\
            \
            const defaultColor = firstFreeColor || palette[0];\
            selectColor(null, defaultColor);\
        \}\
\
        function selectColor(element, colorValue) \{\
            document.getElementById('selected-color-value').value = colorValue;\
            \
            const container = document.getElementById('new-artist-color-picker');\
            const swatches = container.querySelectorAll('.color-swatch');\
            \
            swatches.forEach(swatch => \{\
                swatch.classList.remove('active');\
                if (element && swatch === element) \{\
                    swatch.classList.add('active');\
                \} else if (!element && swatch.className.includes(colorValue)) \{\
                    swatch.classList.add('active');\
                \}\
            \});\
        \}\
\
        function renderAdminTeamList() \{\
             const container = document.getElementById('admin-team-list');\
             const categories = [\
                \{ id: 'chant', label: 'CHANTS', icon: 'fa-microphone-alt', color: 'text-fuchsia-400' \},\
                \{ id: 'piano', label: 'PIANO', icon: 'fa-keyboard', color: 'text-green-400' \},\
                \{ id: 'basse', label: 'BASSE', icon: 'fa-guitar', color: 'text-blue-400' \},\
                \{ id: 'drum', label: 'BATTERIE', icon: 'fa-drum', color: 'text-red-400' \}\
            ];\
            \
            container.innerHTML = categories.map(cat => \{\
                const catArtists = ARTISTS.filter(a => (cat.id === 'chant' && a.group === 'chant') || (a.group === 'musicien' && a.role === cat.id));\
                return `\
                <div class="mb-4">\
                    <h4 class="text-xs font-bold uppercase mb-2 $\{cat.color\} border-b border-white/5 pb-1"><i class="fas $\{cat.icon\} mr-1"></i> $\{cat.label\}</h4>\
                    <div class="grid grid-cols-2 gap-2">\
                        $\{catArtists.map(a => `\
                            <div class="flex justify-between items-center bg-black/30 p-2 rounded border border-white/5 group">\
                                <span class="text-xs font-bold $\{a.color\} px-2 py-1 rounded">$\{a.name\}</span>\
                                <button onclick="askDeleteArtist('$\{a.id\}')" class="text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity p-2"><i class="fas fa-times"></i></button>\
                            </div>\
                        `).join('')\}\
                    </div>\
                </div>`;\
            \}).join('');\
        \}\
        \
        function addNewArtist() \{\
            const name = document.getElementById('new-artist-name').value.toUpperCase().trim();\
            const role = document.getElementById('new-artist-role').value;\
            const color = document.getElementById('selected-color-value').value;\
\
            if(!name) return alert("Nom manquant");\
            if(!color) return alert("Couleur manquante");\
            \
            ARTISTS.push(\{ \
                id: Date.now().toString(), \
                name, \
                color, \
                group: role === 'chant' ? 'chant' : 'musicien', \
                role: role === 'chant' ? undefined : role \
            \});\
\
            document.getElementById('new-artist-name').value = '';\
            renderAdminTeamList();\
            updateColorPicker();\
        \}\
\
        function askDeleteArtist(id) \{\
            artistToDeleteId = id;\
            document.getElementById('delete-modal').classList.remove('hidden');\
        \}\
\
        function confirmDelete() \{\
            if(artistToDeleteId) \{\
                ARTISTS = ARTISTS.filter(a => a.id !== artistToDeleteId);\
                renderAdminTeamList();\
                updateColorPicker(); \
                artistToDeleteId = null;\
                closeModal('delete-modal');\
            \}\
        \}\
\
        function changeMonth(delta) \{ currentDate.setMonth(currentDate.getMonth() + delta); renderPlanning(); \}\
\
        function renderPlanning() \{\
            const container = document.getElementById('planning-container');\
            const sidebar = document.getElementById('artist-sidebar-content');\
            const options = \{ month: 'long'\};\
            const monthName = currentDate.toLocaleDateString('fr-FR', options).toUpperCase();\
            const yearStr = currentDate.getFullYear();\
            document.getElementById('current-month-display').textContent = `$\{monthName\} $\{yearStr\}`;\
\
            let verticalMonthHTML = `<div class="month-sidebar flex flex-col justify-center items-center w-20 md:w-28 shrink-0 mr-4 md:mr-8 rounded-r-3xl border-r border-fuchsia-400/30">`;\
            for(let char of monthName) \{ verticalMonthHTML += `<span class="month-char block text-5xl md:text-7xl font-black mb-0 md:mb-1 text-center w-full cursor-default select-none">$\{char\}</span>`; \}\
            verticalMonthHTML += `</div>`;\
\
            let gridHTML = `<div class="flex-1 overflow-x-auto pb-4"><div class="min-w-[900px] grid grid-cols-[80px_1fr_1fr_1fr_20px_1fr_1fr_1fr] gap-1.5 text-center pb-20 pr-4"><div class=""></div><div class="col-span-3 flex items-center justify-center gap-2 bg-purple-900/40 p-3 rounded-t-xl border border-purple-500/20 backdrop-blur-sm"><i class="fas fa-microphone-alt text-purple-400"></i><span class="font-bold text-purple-100 tracking-[0.2em] uppercase text-xs">Chants</span></div><div></div><div class="col-span-3 flex items-center justify-center gap-2 bg-blue-900/40 p-3 rounded-t-xl border border-blue-500/20 backdrop-blur-sm"><i class="fas fa-music text-blue-400"></i><span class="font-bold text-blue-100 tracking-[0.2em] uppercase text-xs">Musiciens</span></div><div class="bg-white/5 text-gray-400 font-bold text-[10px] uppercase py-3 rounded-l-lg border border-white/5 flex items-center justify-center">DATES</div><div class="bg-purple-500/20 text-purple-200 font-bold text-[10px] uppercase py-3 border border-purple-500/10">Chant 1</div><div class="bg-purple-500/20 text-purple-200 font-bold text-[10px] uppercase py-3 border border-purple-500/10">Chant 2</div><div class="bg-purple-500/20 text-purple-200 font-bold text-[10px] uppercase py-3 border border-purple-500/10 rounded-r-lg">Chant 3</div><div class="flex justify-center"><div class="w-[1px] h-full bg-white/10"></div></div><div class="bg-blue-500/20 text-blue-200 font-bold text-[10px] uppercase py-3 border border-blue-500/10 rounded-l-lg">Piano</div><div class="bg-blue-500/20 text-blue-200 font-bold text-[10px] uppercase py-3 border border-blue-500/10">Basse</div><div class="bg-blue-500/20 text-blue-200 font-bold text-[10px] uppercase py-3 border border-blue-500/10 rounded-r-lg">Drum</div>`;\
\
            const year = currentDate.getFullYear();\
            const month = currentDate.getMonth();\
            const d = new Date(year, month, 1);\
            while(d.getMonth() === month) \{\
                if([3,4,5,6].includes(d.getDay())) \{\
                    const dateStr = d.toISOString().split('T')[0];\
                    const dayName = d.toLocaleDateString('fr-FR', \{weekday: 'long'\});\
                    const dayNum = d.getDate().toString().padStart(2, '0');\
                    const isSat = d.getDay() === 6;\
                    const isToday = new Date().toDateString() === d.toDateString();\
                    const rowColor = isSat ? 'bg-fuchsia-900/40' : 'bg-fuchsia-900/20';\
\
                    gridHTML += `<div class="flex flex-col justify-center items-center h-16 border border-white/5 rounded-lg $\{rowColor\} $\{isToday ? 'ring-2 ring-fuchsia-400' : ''\}"><span class="text-[9px] uppercase text-fuchsia-200 tracking-wider mb-0.5">$\{dayName\}</span><span class="text-xl font-black text-white leading-none">$\{dayNum\}</span></div>`;\
\
                    ['chant1', 'chant2', 'chant3', 'sep', 'piano', 'basse', 'drum'].forEach(slot => \{\
                        if(slot === 'sep') gridHTML += `<div class="flex justify-center h-full"><div class="w-[1px] h-full bg-white/10"></div></div>`;\
                        else \{\
                            const assignKey = `$\{dateStr\}_$\{slot\}`;\
                            const artistId = assignments[assignKey];\
                            const artist = ARTISTS.find(a => a.id === artistId);\
                            const interactClass = isAdminMode ? 'interactive cursor-pointer' : 'cursor-default';\
                            let cellClass = `relative h-16 border border-white/5 bg-black/30 flex items-center justify-center planning-cell rounded-md $\{interactClass\} `;\
                            let cellContent = '';\
                            if(artist) \{\
                                cellClass += `$\{artist.color\} shadow-lg `;\
                                cellContent = `<span class="font-bold text-xs truncate px-2 py-1 select-none">$\{artist.name\}</span>`;\
                                if(selectedArtistId && artist.id === selectedArtistId) cellClass += `cell-highlight `;\
                                else if (selectedArtistId && artist.id !== selectedArtistId) cellClass += `cell-dimmed `;\
                            \} else if (isAdminMode) cellContent = `<i class="fas fa-plus text-white/20 text-xs hover:text-white/80 transition-colors"></i>`;\
                            const clickAction = isAdminMode ? `onclick="handleCellClick('$\{dateStr\}', '$\{slot\}')"` : '';\
                            gridHTML += `<div class="$\{cellClass\}" $\{clickAction\}>$\{cellContent\}</div>`;\
                        \}\
                    \});\
                \}\
                d.setDate(d.getDate() + 1);\
            \}\
            gridHTML += `</div></div>`;\
            container.innerHTML = verticalMonthHTML + gridHTML;\
            \
            const chantsHTML = renderArtistList('chant');\
            const pianosHTML = renderArtistList('musicien', 'piano');\
            const bassesHTML = renderArtistList('musicien', 'basse');\
            const drumsHTML = renderArtistList('musicien', 'drum');\
            \
            let musiciansContent = '';\
            if (pianosHTML) musiciansContent += `<div class="mb-2"><div class="text-[9px] text-green-500 font-bold uppercase mb-1 opacity-70">Piano</div>$\{pianosHTML\}</div>`;\
            if (bassesHTML) musiciansContent += `<div class="mb-2"><div class="text-[9px] text-blue-500 font-bold uppercase mb-1 opacity-70">Basse</div>$\{bassesHTML\}</div>`;\
            if (drumsHTML) musiciansContent += `<div class="mb-2"><div class="text-[9px] text-red-500 font-bold uppercase mb-1 opacity-70">Drum</div>$\{drumsHTML\}</div>`;\
\
            sidebar.innerHTML = `\
            <div class="mb-8">\
                <h3 class="text-[10px] font-bold text-gray-500 uppercase mb-4 pl-1 tracking-[0.2em] flex items-center gap-2"><i class="fas fa-microphone-alt"></i> Chants</h3>\
                <div class="space-y-2">$\{chantsHTML\}</div>\
            </div>\
            <div>\
                <h3 class="text-[10px] font-bold text-gray-500 uppercase mb-4 pl-1 tracking-[0.2em] flex items-center gap-2"><i class="fas fa-music"></i> Musiciens</h3>\
                <div class="space-y-2">$\{musiciansContent\}</div>\
            </div>`;\
        \}\
\
        // ... existing helper functions ...\
        function handleCellClick(dateStr, slot) \{\
            if(!isAdminMode) return; \
            currentEditSlot = \{ dateStr, slot \};\
            let allowedGroup = slot.startsWith('chant') ? 'chant' : 'musicien';\
            let allowedRole = null;\
            if(allowedGroup === 'musicien') allowedRole = slot; \
            const filteredArtists = ARTISTS.filter(a => \{\
                if(a.group !== allowedGroup) return false;\
                if(allowedRole && a.role !== allowedRole) return false;\
                return true;\
            \});\
            const modalList = document.getElementById('modal-artist-list');\
            if(filteredArtists.length === 0) modalList.innerHTML = `<p class="col-span-2 text-center text-gray-500 text-xs italic py-4">Aucun artiste trouv\'e9 pour "$\{slot.toUpperCase()\}".<br>G\'e9rez l'\'e9quipe dans l'onglet Administration.</p>`;\
            else modalList.innerHTML = filteredArtists.map(a => `<button onclick="setAssignment('$\{a.id\}')" class="$\{a.color\} px-2 py-3 rounded-lg text-xs font-bold hover:scale-105 transition-transform shadow-md">$\{a.name\}</button>`).join('');\
            document.getElementById('modal-slot-info').innerText = `$\{dateStr\} \'95 $\{slot.toUpperCase()\}`;\
            document.getElementById('assign-modal').classList.remove('hidden');\
        \}\
\
        function setAssignment(artistId) \{\
            if(currentEditSlot) \{\
                assignments[`$\{currentEditSlot.dateStr\}_$\{currentEditSlot.slot\}`] = artistId;\
                saveAllData(); \
                renderPlanning();\
                closeModal('assign-modal');\
            \}\
        \}\
\
        function removeAssignment() \{\
            if(currentEditSlot) \{\
                delete assignments[`$\{currentEditSlot.dateStr\}_$\{currentEditSlot.slot\}`];\
                saveAllData(); \
                renderPlanning();\
                closeModal('assign-modal');\
            \}\
        \}\
\
        function closeModal(modalId) \{\
            document.getElementById(modalId).classList.add('hidden');\
            if(modalId === 'assign-modal') currentEditSlot = null;\
            if(modalId === 'delete-modal') artistToDeleteId = null;\
            if(modalId === 'delete-audio-modal') audioToDeleteId = null;\
        \}\
\
        function renderArtistList(group, specificRole = null) \{\
            return ARTISTS.filter(a => \{\
                if (group === 'chant') return a.group === 'chant';\
                if (group === 'musicien') \{\
                     if (a.group !== 'musicien') return false;\
                     return specificRole ? a.role === specificRole : true;\
                \}\
                return false;\
            \}).map(artist => \{\
                const isSelected = selectedArtistId === artist.id;\
                let scheduleHTML = '';\
                if (isSelected) scheduleHTML = getArtistScheduleHTML(artist.id);\
\
                return `\
                <div class="mb-1">\
                    <button onclick="toggleArtistFilter('$\{artist.id\}')" class="artist-pill w-full px-3 py-2 rounded-full text-[10px] font-black uppercase tracking-wider flex items-center justify-center relative $\{artist.color\} $\{isSelected ? 'selected' : 'opacity-80 hover:opacity-100'\}">\
                        $\{artist.name\}\
                        $\{isSelected ? '<span class="absolute right-3 w-1.5 h-1.5 bg-white rounded-full animate-pulse shadow-[0_0_5px_white]"></span>' : ''\}\
                    </button>\
                    $\{scheduleHTML\}\
                </div>`;\
            \}).join('');\
        \}\
\
        function getArtistScheduleHTML(artistId) \{\
            const artistAssignments = [];\
            for (const [key, assignedId] of Object.entries(assignments)) \{\
                if (assignedId === artistId) \{\
                    const [dateStr, slot] = key.split('_');\
                    const date = new Date(dateStr);\
                    if (date.getMonth() === currentDate.getMonth() && date.getFullYear() === currentDate.getFullYear()) \{\
                        artistAssignments.push(\{ date, slot \});\
                    \}\
                \}\
            \}\
            artistAssignments.sort((a, b) => a.date - b.date);\
\
            if (artistAssignments.length === 0) return '<div class="text-[9px] text-gray-500 text-center py-1 schedule-dropdown">Aucune date ce mois-ci</div>';\
\
            return `\
            <div class="mt-1 bg-white/5 rounded-lg p-2 schedule-dropdown">\
                <ul class="space-y-1">\
                    $\{artistAssignments.map(a => \{\
                        const dayName = a.date.toLocaleDateString('fr-FR', \{weekday: 'short'\});\
                        const dayNum = a.date.getDate().toString().padStart(2, '0');\
                        const slotFormatted = a.slot.toUpperCase().replace(/(\\d+)$/, ' $1');\
                        return `<li class="flex justify-between text-[10px] text-gray-300">\
                            <span class="font-bold text-fuchsia-400 capitalize">$\{dayName\} $\{dayNum\}</span>\
                            <span class="uppercase opacity-70 text-[9px]">$\{slotFormatted\}</span>\
                        </li>`;\
                    \}).join('')\}\
                </ul>\
            </div>\
            `;\
        \}\
\
        function toggleArtistFilter(id) \{\
            if(selectedArtistId === id) selectedArtistId = null;\
            else selectedArtistId = id;\
            renderPlanning();\
        \}\
\
        window.onload = function() \{\
            loadData();\
            showPage('home'); \
        \};\
    </script>\
</body>\
</html>}